

<!DOCTYPE html>


<html lang="zh-CN" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>WindowBot &#8212; Aibote  文档</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tabs.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/translations.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'dev_manual/window_bot/index';</script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="WebBot" href="../web_bot/index.html" />
    <link rel="prev" title="AndroidBot" href="../android_bot/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="zh-CN"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  <div class="navbar-header-items__start">
    
      <div class="navbar-item">
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
    <p class="title logo__title">Aibote  文档</p>
  
</a></div>
    
  </div>
  
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        Aibote 基本使用
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Aibote 开发手册
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../reference/index.html">
                        API reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
        </div>
      
      
        <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">
<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="搜索" aria-label="搜索" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item"><nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../user_guide/index.html">
                        Aibote 基本使用
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        Aibote 开发手册
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../../reference/index.html">
                        API reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">
<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item"><nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../android_bot/index.html">AndroidBot</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">WindowBot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_bot/index.html">WebBot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../web_socket_bot/index.html">WebSocketBot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multimodule_mixing/index.html">多模块混合开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ui/index.html">界面开发</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumbs">
  <ul class="bd-breadcrumbs" role="navigation" aria-label="Breadcrumb">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">Aibote 开发手册</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">WindowBot</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="windowbot">
<h1>WindowBot<a class="headerlink" href="#windowbot" title="此标题的永久链接">#</a></h1>
<section id="id1">
<h2>主函数示例<a class="headerlink" href="#id1" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-0-0-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-0-0-0" name="0-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-0-0-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-0-0-1" name="0-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-0-0-0" class="sphinx-tabs-panel" id="panel-0-0-0" name="0-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">const</span><span class="w"> </span><span class="nx">WindowsBot</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">require</span><span class="p">(</span><span class="s1">&#39;WindowsBot&#39;</span><span class="p">);</span><span class="c1">//引用WindowsBot模块</span>

<span class="c1">//注册主函数</span>
<span class="nx">WindowsBot</span><span class="p">.</span><span class="nx">registerMain</span><span class="p">(</span><span class="nx">windowsMain</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">26678</span><span class="p">);</span>

<span class="cm">/**用作代码提示，windowsMain函数会被多次调用，注意使用全局变量</span>
<span class="cm"> * @param {WindowsBot} windowsBot</span>
<span class="cm"> */</span>
<span class="k">async</span><span class="w"> </span><span class="kd">function</span><span class="w"> </span><span class="nx">windowsMain</span><span class="p">(</span><span class="nx">windowsBot</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//设置隐式等待</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">setImplicitTimeout</span><span class="p">(</span><span class="mf">5000</span><span class="p">);</span>

<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">hwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;运行&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">clickElement</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Window/Button[2]&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-0-0-1" class="sphinx-tabs-panel" hidden="true" id="panel-0-0-1" name="0-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id2">
<h2>注册主函数<a class="headerlink" href="#id2" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-1-1-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-1-1-0" name="1-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-1-1-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-1-1-1" name="1-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-1-1-0" class="sphinx-tabs-panel" id="panel-1-1-0" name="1-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="nx">WindowsBot</span><span class="p">.</span><span class="nx">registerMain</span><span class="p">(</span><span class="nx">windowsMain</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;127.0.0.1&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">26678</span><span class="p">);</span>
<span class="c1">// 参数一 回调函数，要注册的函数，必须含一个参数，用作接收WindowsBot对象</span>
<span class="c1">// 参数二 字符串型， 脚本所在的地址，传递给WindowsDriver.exe。如果值为 &quot;127.0.0.1&quot;脚本会将参数 ip和port作为启动参数并启动WindowsDriver.exe，否则用户需要手动启动WindowsDriver.exe 并且提供启动参数。</span>
<span class="c1">// 命令行启动示例：WindowsDriver.exe &quot;192.168.1.88&quot; 26678</span>
<span class="c1">// 脚本多进程需要指定不同的端口！</span>
<span class="c1">// 参数三 整型，监听端口, WindowsDriver.exe。默认26678。WindowsDriver.exe会通过ip和port 连接脚本</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 远程云端部署</span>
<span class="nx">WindowsBot</span><span class="p">.</span><span class="nx">registerMain</span><span class="p">(</span><span class="nx">windowsMain</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;192.168.1.88&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">26678</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-1-1-1" class="sphinx-tabs-panel" hidden="true" id="panel-1-1-1" name="1-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id3">
<h2>等待超时<a class="headerlink" href="#id3" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-2-2-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-2-2-0" name="2-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-2-2-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-2-2-1" name="2-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-2-2-0" class="sphinx-tabs-panel" id="panel-2-2-0" name="2-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">sleep</span><span class="p">(</span><span class="mf">3000</span><span class="p">);</span>
<span class="c1">// 显示等待</span>
<span class="c1">// 参数一 整型，等待时间，单位毫秒</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">setImplicitTimeout</span><span class="p">(</span><span class="nx">waitMs</span><span class="p">,</span><span class="w"> </span><span class="nx">intervalMs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">5</span><span class="p">);</span>
<span class="c1">// 隐式等待</span>
<span class="c1">// 参数一 整型，等待时间，单位毫秒</span>
<span class="c1">// 参数二 整型，心跳间隔，单位毫秒。可选参数，默认5毫秒</span>
<span class="c1">// 作用全局，程序起始设置一次即可。并发会影响实际等待时间</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-2-2-1" class="sphinx-tabs-panel" hidden="true" id="panel-2-2-1" name="2-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id4">
<h2>查找句柄<a class="headerlink" href="#id4" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-3-3-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-3-3-0" name="3-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-3-3-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-3-3-1" name="3-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-3-3-0" class="sphinx-tabs-panel" id="panel-3-3-0" name="3-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="nx">className</span><span class="p">,</span><span class="w"> </span><span class="nx">windowName</span><span class="p">);</span>
<span class="c1">// 查找窗口句柄，仅查找顶级窗口，不包含子窗口</span>
<span class="c1">// 参数一 字符串型，窗口类名</span>
<span class="c1">// 参数二 字符串型，窗口名</span>
<span class="c1">// 成功返回窗口句柄，失败返回null</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 不同的应用中相同窗口类名比较常见，使用类名查找句柄要确保窗口类名唯一性</span>
<span class="c1">// 通过类名查找句柄</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="s2">&quot;#32770&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>

<span class="c1">//通过窗口名称查找句柄</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;运行&quot;</span><span class="p">);</span>

<span class="c1">//通过窗口名称和类名查找句柄</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="s2">&quot;#32770&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;运行&quot;</span><span class="p">);</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindows</span><span class="p">(</span><span class="nx">className</span><span class="p">,</span><span class="w"> </span><span class="nx">windowName</span><span class="p">);</span>
<span class="c1">// 查找窗口句柄数组，仅查找顶级窗口，不包含子窗口。className和windowNmae都为null，则返回所有窗口句柄</span>
<span class="c1">// 参数一 字符串型，窗口类名</span>
<span class="c1">// 参数二 字符串型，窗口名</span>
<span class="c1">// 成功返回窗口句柄数组，失败返回null</span>

<span class="c1">// 代码示例</span>
<span class="c1">//通过类名查找句柄数组</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hwnds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="s2">&quot;Chrome_WidgetWin_1&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">);</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findSubWindow</span><span class="p">(</span><span class="nx">curHwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">className</span><span class="p">,</span><span class="w"> </span><span class="nx">windowName</span><span class="p">);</span>
<span class="c1">// 查找子窗口句柄</span>
<span class="c1">// 参数一 字符串/整型，当前窗口句柄</span>
<span class="c1">// 参数二 字符串型，窗口类名</span>
<span class="c1">// 参数三 字符串型，窗口名</span>
<span class="c1">// 成功返回窗口句柄，失败返回null</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 查找指定窗口的子窗口句柄</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="s2">&quot;#32770&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;设备投屏1&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">subHwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findSubWindow</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;001  GDBNW19A45831389&quot;</span><span class="p">);</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findParentWindow</span><span class="p">(</span><span class="nx">curHwnd</span><span class="p">);</span>
<span class="c1">// 查找父窗口句柄</span>
<span class="c1">// 参数一 字符串/整型，当前窗口句柄</span>
<span class="c1">// 成功返回窗口句柄，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findDesktopWindow</span><span class="p">();</span>
<span class="c1">// 查找桌面窗口句柄</span>
<span class="c1">// 成功返回窗口句柄，失败返回null</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-3-3-1" class="sphinx-tabs-panel" hidden="true" id="panel-3-3-1" name="3-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id5">
<h2>获取窗口名称<a class="headerlink" href="#id5" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-4-4-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-4-4-0" name="4-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-4-4-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-4-4-1" name="4-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-4-4-0" class="sphinx-tabs-panel" id="panel-4-4-0" name="4-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getWindowName</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">);</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 成功返回窗口名称，失败返回null</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-4-4-1" class="sphinx-tabs-panel" hidden="true" id="panel-4-4-1" name="4-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id6">
<h2>窗口操作<a class="headerlink" href="#id6" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-5-5-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-5-5-0" name="5-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-5-5-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-5-5-1" name="5-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-5-5-0" class="sphinx-tabs-panel" id="panel-5-5-0" name="5-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">showWindow</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">isShow</span><span class="p">);</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 布尔型，显示窗口 true， 隐藏窗口 false</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">setWindowTop</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">isTop</span><span class="p">);</span>
<span class="c1">// 设置窗口到最顶层</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 整型，是否置顶。true置顶， false取消置顶</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getWindowPos</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">);</span>
<span class="c1">// 获取窗口位置</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 成功返回窗口位置，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">setWindowPos</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">left</span><span class="p">,</span><span class="w"> </span><span class="nx">top</span><span class="p">,</span><span class="w"> </span><span class="nx">width</span><span class="p">,</span><span class="w"> </span><span class="nx">height</span><span class="p">);</span>
<span class="c1">// 设置窗口位置</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 整型，左上角横坐标</span>
<span class="c1">// 参数三 整型，左上角纵坐标</span>
<span class="c1">// 参数四 整型，窗口宽度</span>
<span class="c1">// 参数五 整型，窗口高度</span>
<span class="c1">// 成功返回true，失败返回 false</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-5-5-1" class="sphinx-tabs-panel" hidden="true" id="panel-5-5-1" name="5-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id7">
<h2>鼠标键盘<a class="headerlink" href="#id7" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-6-6-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-6-6-0" name="6-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-6-6-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-6-6-1" name="6-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-6-6-0" class="sphinx-tabs-panel" id="panel-6-6-0" name="6-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">moveMouse</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{});</span>
<span class="c1">// 移动鼠标</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 整型，横坐标</span>
<span class="c1">// 参数三 整型，纵坐标</span>
<span class="c1">// 参数四 JSON类型，可选参数{{mode:boolean, elementHwnd:string|number}} options 操作模式，后台 true，前台 false。默认前台操作。</span>
<span class="c1">// 如果mode值为true且目标控件有单独的句柄，则需要通过getElementWindow获得元素句柄，指定elementHwnd的值(极少应用窗口由父窗口响应消息，则无需指定)</span>
<span class="c1">// 总是返回true</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 前台移动鼠标</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">moveMouse</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">200</span><span class="p">);</span>

<span class="c1">// 后台移动鼠标</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">moveMouse</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">200</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">});</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">moveMouseRelative</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="c1">// 移动鼠标(相对坐标)</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 整型，相对横坐标</span>
<span class="c1">// 参数三 整型，相对纵坐标</span>
<span class="c1">// 参数四 布尔型，操作模式，后台 true，前台 false。默认前台操作</span>
<span class="c1">// 总是返回true</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">rollMouse</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">dwData</span><span class="p">,</span><span class="w"> </span><span class="nx">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="c1">// 滚动鼠标</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 整型，横坐标</span>
<span class="c1">// 参数三 整型，纵坐标</span>
<span class="c1">// 参数四 整型，鼠标滚动次数,负数下滚鼠标,正数上滚鼠标</span>
<span class="c1">// 参数五 布尔型，操作模式，后台 true，前台 false。默认前台操作</span>
<span class="c1">// 总是返回true</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">clickMouse</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">msg</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{});</span>
<span class="c1">// 鼠标点击</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 整型，横坐标</span>
<span class="c1">// 参数三 整型，纵坐标</span>
<span class="c1">// 参数四 整型，点击类型，单击左键:1 单击右键:2 按下左键:3 弹起左键:4 按下右键:5 弹起右键:6 双击左键:7 双击右键:8</span>
<span class="c1">// 参数五 JSON类型，可选参数{{mode:boolean, elementHwnd:string|number}} options 操作模式，后台 true，前台 false。默认前台操作。</span>
<span class="c1">// 如果mode值为true且目标控件有单独的句柄，则需要通过getElementWindow获得元素句柄，指定elementHwnd的值(极少应用窗口由父窗口响应消息，则无需指定)</span>
<span class="c1">// 总是返回true。</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 前台单击左键</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;运行&quot;</span><span class="p">);</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">clickMouse</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">200</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>

<span class="c1">// 后台单击左键(目标坐标点没有单独的句柄)</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">clickMouse</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">200</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">});</span>

<span class="c1">// 后台单击左键(目标坐标点有单独的句柄)</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">subHwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getElementWindow</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Window/Button[2]&quot;</span><span class="p">);</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">clickMouse</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">200</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">mode</span><span class="o">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">elementHwnd</span><span class="o">:</span><span class="w"> </span><span class="nx">subHwnd</span><span class="p">});</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">sendKeys</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
<span class="c1">// 输入文本</span>
<span class="c1">// 参数一 字符串型，输入的文本</span>
<span class="c1">// 总是返回true</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">sendKeysByHwnd</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">text</span><span class="p">);</span>
<span class="c1">// 后台输入文本(杀毒软件可能会拦截)</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄，如果目标控件有单独的句柄，需要通过getElementWindow获得句柄</span>
<span class="c1">// 参数二 字符串型，输入的文本</span>
<span class="c1">// 总是返回true</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 后台输入文本(目标坐标点有单独的句柄)</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;运行&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">subHwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getElementWindow</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ComboBox/Edit&quot;</span><span class="p">);</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">sendKeysByHwnd</span><span class="p">(</span><span class="nx">subHwnd</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;cmd&quot;</span><span class="p">);</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">sendVk</span><span class="p">(</span><span class="nx">bVk</span><span class="p">,</span><span class="w"> </span><span class="nx">msg</span><span class="p">);</span>
<span class="c1">// 输入虚拟键值(VK)</span>
<span class="c1">// 参数一 整型，VK键值</span>
<span class="c1">// 参数二 整型，输入类型，按下弹起:1 按下:2 弹起:3</span>
<span class="c1">// 总是返回true</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">sendVkByHwnd</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">bVk</span><span class="p">,</span><span class="w"> </span><span class="nx">msg</span><span class="p">);</span>
<span class="c1">// 后台输入虚拟键值(VK) (杀毒软件可能会拦截)</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄，如果目标控件有单独的句柄，需要通过getElementWindow获得句柄</span>
<span class="c1">// 参数二 整型，VK键值</span>
<span class="c1">// 参数三 整型，输入类型，按下弹起:1 按下:2 弹起:3</span>
<span class="c1">// 总是返回true。若是后台组合键，可使用sendVk 按下控制键(Alt、Shift、Ctrl...)，再组合其他按键</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 后台输入键盘&quot;A&quot;(目标坐标点有单独的句柄)</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">hwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWindow</span><span class="p">(</span><span class="kc">null</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;运行&quot;</span><span class="p">);</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">subHwnd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getElementWindow</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;ComboBox/Edit&quot;</span><span class="p">);</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">sendVkByHwnd</span><span class="p">(</span><span class="nx">subHwnd</span><span class="p">,</span><span class="w"> </span><span class="mh">0x41</span><span class="p">,</span><span class="w"> </span><span class="mf">1</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-6-6-1" class="sphinx-tabs-panel" hidden="true" id="panel-6-6-1" name="6-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id8">
<h2>图色操作<a class="headerlink" href="#id8" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-7-7-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-7-7-0" name="7-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-7-7-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-7-7-1" name="7-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-7-7-0" class="sphinx-tabs-panel" id="panel-7-7-0" name="7-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">saveScreenshot</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">savePath</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{});</span>
<span class="c1">// 截图保存</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 字符串类型，保存图片路径。</span>
<span class="c1">// 参数三 JSON类型，可选参数{{region:[left:number, top:number, right:number, bottom:number], threshold:[thresholdType:number, thresh:number, maxval:number], mode:boolean}} options</span>
<span class="c1">// region截图区域 [10, 20, 100, 200], 默认 hwnd对应的窗口</span>
<span class="c1">// threshold二值化图片, thresholdType算法类型：</span>
<span class="c1">//  0   THRESH_BINARY算法，当前点值大于阈值thresh时，取最大值maxva，否则设置为0</span>
<span class="c1">//  1   THRESH_BINARY_INV算法，当前点值大于阈值thresh时，设置为0，否则设置为最大值maxva</span>
<span class="c1">//  2   THRESH_TOZERO算法，当前点值大于阈值thresh时，不改变，否则设置为0</span>
<span class="c1">//  3   THRESH_TOZERO_INV算法，当前点值大于阈值thresh时，设置为0，否则不改变</span>
<span class="c1">//  4   THRESH_TRUNC算法，当前点值大于阈值thresh时，设置为阈值thresh，否则不改变</span>
<span class="c1">//  5   ADAPTIVE_THRESH_MEAN_C算法，自适应阈值</span>
<span class="c1">//  6   ADAPTIVE_THRESH_GAUSSIAN_C算法，自适应阈值</span>
<span class="c1">//  thresh阈值，maxval最大值，threshold默认保存原图。thresh和maxval同为255时灰度处理</span>
<span class="c1">// mode操作模式，后台 true，前台 false。默认前台操作</span>
<span class="c1">// 成功返回false，失败返回true</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 截取窗口全屏，图片保存至d:\\1.png</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">savePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;d:\\1.png&quot;</span><span class="p">;</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">saveScreenshot</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">savePath</span><span class="p">);</span>

<span class="c1">// 二值化区域截图，区域起始坐标位置(10,20)，右下角坐标位置(100,200)。二值化使用THRESH_BINARY算法。阈值127，最大值255</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">],</span><span class="w"> </span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">127</span><span class="p">,</span><span class="w"> </span><span class="mf">255</span><span class="p">]};</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">saveScreenshot</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">savePath</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">);</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getColor</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">x</span><span class="p">,</span><span class="w"> </span><span class="nx">y</span><span class="p">,</span><span class="w"> </span><span class="nx">mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="c1">// 获取指定坐标点的色值</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 整型，横坐标</span>
<span class="c1">// 参数三 整型，纵坐标</span>
<span class="c1">// 参数四 布尔型，操作模式，可选参数，后台 true，前台 false。默认前台操作</span>
<span class="c1">// 成功返回#开头的颜色值，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findImage</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">imagePath</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{});</span>
<span class="c1">// 找图</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 字符串，小图片路径</span>
<span class="c1">// 参数三 JSON类型，可选参数，{{region:[left:number, top:number, right:number, bottom:number], sim:number, threshold:[thresholdType:number, thresh:number, maxval:number], mode:boolean}} options</span>
<span class="c1">// region 指定区域找图 [10, 20, 100, 200]，region默认 hwnd对应的窗口</span>
<span class="c1">// sim浮点型 图片相似度 0.0-1.0，sim默认0.95</span>
<span class="c1">// threshold二值化图片, thresholdType算法类型：</span>
<span class="c1">//   0   THRESH_BINARY算法，当前点值大于阈值thresh时，取最大值maxva，否则设置为0</span>
<span class="c1">//   1   THRESH_BINARY_INV算法，当前点值大于阈值thresh时，设置为0，否则设置为最大值maxva</span>
<span class="c1">//   2   THRESH_TOZERO算法，当前点值大于阈值thresh时，不改变，否则设置为0</span>
<span class="c1">//   3   THRESH_TOZERO_INV算法，当前点值大于阈值thresh时，设置为0，否则不改变</span>
<span class="c1">//   4   THRESH_TRUNC算法，当前点值大于阈值thresh时，设置为阈值thresh，否则不改变</span>
<span class="c1">//   5   ADAPTIVE_THRESH_MEAN_C算法，自适应阈值</span>
<span class="c1">//   6   ADAPTIVE_THRESH_GAUSSIAN_C算法，自适应阈值</span>
<span class="c1">//   thresh阈值，maxval最大值，threshold默认保存原图。thresh和maxval同为255时灰度处理</span>
<span class="c1">// multi 找图数量，默认为1,找单个图片坐标</span>
<span class="c1">// mode 操作模式，后台 true，前台 false。默认前台操作</span>
<span class="c1">// 成功返回，单个坐标点 [{x:number, y:number}]，多坐标点图[{x1:number, y1:number}, {x2:number, y2:number}...] 失败返回null</span>

<span class="c1">// 代码示例</span>
<span class="c1">//全屏找图</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">imagePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;d:\\1.png&quot;</span><span class="p">;</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findImage</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">imagePath</span><span class="p">);</span>

<span class="c1">// 区域+模糊 找图，区域起始坐标位置(10, 15)，右下角坐标位置(100, 100)。图片相似度设置为95%</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">15</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">],</span><span class="w"> </span><span class="nx">sim</span><span class="o">:</span><span class="w"> </span><span class="mf">0.95</span><span class="p">};</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findImage</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">imagePath</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">);</span>

<span class="c1">// 二值化，使用THRESH_BINARY算法，阈值127 最大值255。二值化找图需要在截图工具设置相同的算法、阈值和最大值</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">threshold</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">127</span><span class="p">,</span><span class="w"> </span><span class="mf">255</span><span class="p">]};</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findImage</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">imagePath</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">);</span>

<span class="c1">// 找多张相同图片坐标，返回坐标数组。</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">multi</span><span class="o">:</span><span class="w"> </span><span class="mf">3</span><span class="p">};</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findImage</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">imagePath</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">);</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findAnimation</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">frameRate</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{});</span>
<span class="c1">// 找动态图</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 整型，前后两张图相隔的时间，单位毫秒</span>
<span class="c1">// 参数三 JSON类型，可选参数，{{region:[left:number, top:number, right:number, bottom:number], mode:boolean}} options</span>
<span class="c1">// region 指定区域找图 [10, 20, 100, 200]，region默认 hwnd对应的窗口</span>
<span class="c1">// mode 操作模式，后台 true，前台 false。默认前台操作</span>
<span class="c1">// 成功返回，单个坐标点 [{x:number, y:number}]，多坐标点图[{x1:number, y1:number}, {x2:number, y2:number}...] 失败返回null</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 在100毫秒内找出图片内变化的位置，其他参数参考findImage函数</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findAnimation</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">);</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findColor</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">mainColor</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{});</span>
<span class="c1">// 查找指定色值的坐标点</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 字符串，#开头的色值</span>
<span class="c1">// 参数三 JSON类型，可选参数，{{subColors:[[offsetX:number, offsetY:number, strSubColor:string], ...], region:[left:number, top:number, right:number, bottom:numbe], sim:number, mode:boolean}} options</span>
<span class="c1">// subColors 相对于mainColor 的子色值，[[offsetX, offsetY, &quot;#FFFFFF&quot;], ...]，subColors默认为null</span>
<span class="c1">// region 指定区域找图 [10, 20, 100, 200]，region默认 hwnd对应的窗口</span>
<span class="c1">// sim相似度0.0-1.0，sim默认为1</span>
<span class="c1">// mode 操作模式，后台 true，前台 false。默认前台操作</span>
<span class="c1">// 成功返回{x:number, y:number} 失败返回null</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 指定区域+模糊 找色。区域起始坐标位置(10, 20)，右下角坐标位置(100, 200)。颜色相似度设置为95%</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">mainColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;#ffff00&quot;</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">200</span><span class="p">],</span><span class="w"> </span><span class="nx">sim</span><span class="o">:</span><span class="w"> </span><span class="mf">0.95</span><span class="p">};</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findColor</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">mainColor</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">);</span>

<span class="c1">// 多点区域找色。区域起始坐标位置(10, 20)，右下角坐标位置(100, 200)。主颜色与3个子颜色 点的偏移坐标点。偏移点的计算(子颜色坐标点-主颜色坐标点)</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">mainColor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;#ffff00&quot;</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">region</span><span class="o">:</span><span class="w"> </span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">200</span><span class="p">],</span><span class="w"> </span><span class="nx">subColors</span><span class="o">:</span><span class="w"> </span><span class="p">[[</span><span class="mf">8</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;#a09588&quot;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">9</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;#ffffff&quot;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;#ffdc92&quot;</span><span class="p">]]};</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findColor</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">mainColor</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">);</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">compareColor</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">mainX</span><span class="p">,</span><span class="w"> </span><span class="nx">mainY</span><span class="p">,</span><span class="w"> </span><span class="nx">mainColor</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{});</span>
<span class="c1">// 比较指定坐标点的颜色值</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 整型，主颜色所在的X坐标</span>
<span class="c1">// 参数三 整型，主颜色所在的Y坐标</span>
<span class="c1">// 参数四 字符串，#开头的色值</span>
<span class="c1">// 参数五 JSON类型，可选参数，{{subColors:[[offsetX:number, offsetY:number, strSubColor:string], ...], region:[left:number, top:number, right:number, bottom:number], sim:number, mode:boolean}} options</span>
<span class="c1">// subColors 相对于mainColor 的子色值，[[offsetX, offsetY, &quot;#FFFFFF&quot;], ...]，subColors默认为null</span>
<span class="c1">// region 指定区域找图 [10, 20, 100, 200]，region默认 hwnd对应的窗口</span>
<span class="c1">// sim相似度0.0-1.0，sim默认为1</span>
<span class="c1">// 成功返回true 失败返回 false</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 多点+模糊比色，主颜色值&quot;#ffff00&quot; 坐标位置(100,150)。主颜色与3个子颜色 点的偏移坐标点。偏移点的计算(子颜色坐标点-主颜色坐标点)。颜色相似度98%</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="nx">subColors</span><span class="o">:</span><span class="w"> </span><span class="p">[[</span><span class="mf">8</span><span class="p">,</span><span class="w"> </span><span class="mf">2</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;#a09588&quot;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">9</span><span class="p">,</span><span class="w"> </span><span class="mf">5</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;#ffffff&quot;</span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">6</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;#ffdc92&quot;</span><span class="p">]],</span><span class="w"> </span><span class="nx">sim</span><span class="o">:</span><span class="w"> </span><span class="mf">0.98</span><span class="p">};</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">compareColor</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">150</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;#ffff00&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-7-7-1" class="sphinx-tabs-panel" hidden="true" id="panel-7-7-1" name="7-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="ocr">
<h2>OCR系统<a class="headerlink" href="#ocr" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-8-8-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-8-8-0" name="8-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-8-8-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-8-8-1" name="8-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-8-8-0" class="sphinx-tabs-panel" id="panel-8-8-0" name="8-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWords</span><span class="p">(</span><span class="nx">hwndOrImagePath</span><span class="p">,</span><span class="w"> </span><span class="nx">words</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{})</span>
<span class="c1">// 找字</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄或者图片路径</span>
<span class="c1">// 参数二 字符串类型，要查找的文字</span>
<span class="c1">// 参数三 JSON类型，可选参数 {region:[left:number, top:number, right:number, bottom:number], threshold:[thresholdType:number, thresh:number, maxval:number], mode:boolean} options</span>
<span class="c1">// region 指定区域 [10, 20, 100, 200]，region默认全图</span>
<span class="c1">// threshold二值化图片, thresholdType算法类型：</span>
<span class="c1">//  0   THRESH_BINARY算法，当前点值大于阈值thresh时，取最大值maxva，否则设置为0</span>
<span class="c1">//  1   THRESH_BINARY_INV算法，当前点值大于阈值thresh时，设置为0，否则设置为最大值maxva</span>
<span class="c1">//  2   THRESH_TOZERO算法，当前点值大于阈值thresh时，不改变，否则设置为0</span>
<span class="c1">//  3   THRESH_TOZERO_INV算法，当前点值大于阈值thresh时，设置为0，否则不改变</span>
<span class="c1">//  4   THRESH_TRUNC算法，当前点值大于阈值thresh时，设置为阈值thresh，否则不改变</span>
<span class="c1">//  5   ADAPTIVE_THRESH_MEAN_C算法，自适应阈值</span>
<span class="c1">//  6   ADAPTIVE_THRESH_GAUSSIAN_C算法，自适应阈值</span>
<span class="c1">//  thresh阈值，maxval最大值，threshold默认保存原图。thresh和maxval同为255时灰度处理</span>
<span class="c1">// mode 操作模式，后台 true，前台 false。默认前台操作, 仅适用于hwnd</span>
<span class="c1">// 成功功返回数组[{x:number, y:number}, ...]，文字所在的坐标点， 失败返回null</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 后台区域找字</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWords</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;rpa&quot;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">region</span><span class="o">:</span><span class="p">[</span><span class="mf">10</span><span class="p">,</span><span class="w"> </span><span class="mf">20</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">200</span><span class="p">],</span><span class="w"> </span><span class="nx">mode</span><span class="o">:</span><span class="kc">true</span><span class="p">});</span>

<span class="c1">// 二值化处理后找字</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">findWords</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;rpa&#39;</span><span class="p">,</span><span class="w"> </span><span class="p">{</span><span class="nx">threshold</span><span class="o">:</span><span class="p">[</span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">100</span><span class="p">,</span><span class="w"> </span><span class="mf">255</span><span class="p">]});</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getWords</span><span class="p">(</span><span class="nx">hwndOrImagePath</span><span class="p">,</span><span class="w"> </span><span class="nx">options</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{})</span>
<span class="c1">// 获取屏幕文字</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄或者图片路径</span>
<span class="c1">// 参数二 JSON类型，可选参数 {region:[left:number, top:number, right:number, bottom:number], threshold:[thresholdType:number, thresh:number, maxval:number], mode:boolean} options</span>
<span class="c1">// region 指定区域 [10, 20, 100, 200]，region默认全图</span>
<span class="c1">// threshold二值化图片, thresholdType算法类型：</span>
<span class="c1">//   0   THRESH_BINARY算法，当前点值大于阈值thresh时，取最大值maxva，否则设置为0</span>
<span class="c1">//   1   THRESH_BINARY_INV算法，当前点值大于阈值thresh时，设置为0，否则设置为最大值maxva</span>
<span class="c1">//   2   THRESH_TOZERO算法，当前点值大于阈值thresh时，不改变，否则设置为0</span>
<span class="c1">//   3   THRESH_TOZERO_INV算法，当前点值大于阈值thresh时，设置为0，否则不改变</span>
<span class="c1">//   4   THRESH_TRUNC算法，当前点值大于阈值thresh时，设置为阈值thresh，否则不改变</span>
<span class="c1">//   5   ADAPTIVE_THRESH_MEAN_C算法，自适应阈值</span>
<span class="c1">//   6   ADAPTIVE_THRESH_GAUSSIAN_C算法，自适应阈值</span>
<span class="c1">// thresh阈值，maxval最大值，threshold默认保存原图。thresh和maxval同为255时灰度处理</span>
<span class="c1">// mode 操作模式，后台 true，前台 false。默认前台操作, 仅适用于hwnd</span>
<span class="c1">// 成功返回手机上的文字, 失败返回null</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 获取图片上的文字</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">words</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getWords</span><span class="p">(</span><span class="s2">&quot;d:\\1.png&quot;</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">words</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-8-8-1" class="sphinx-tabs-panel" hidden="true" id="panel-8-8-1" name="8-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id9">
<h2>元素操作<a class="headerlink" href="#id9" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-9-9-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-9-9-0" name="9-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-9-9-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-9-9-1" name="9-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-9-9-0" class="sphinx-tabs-panel" id="panel-9-9-0" name="9-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getElementName</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">);</span>
<span class="c1">// 获取元素名称</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄。如果是java窗口并且窗口句柄和元素句柄不一致，需要使用getElementWindow获取窗口句柄。</span>
<span class="c1">// getElementWindow参数的xpath，Aibote Tool应当使用正常模式下获取的XPATH路径，不要 “勾选java窗口” 复选按钮。对话框子窗口，需要获取对应的窗口句柄操作</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 成功返回元素名称，失败返回null</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 遍历xpath 获取所有兄弟节点name</span>
<span class="k">for</span><span class="p">(</span><span class="kd">let</span><span class="w"> </span><span class="nx">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">;</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="nx">i</span><span class="o">++</span><span class="p">){</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getElementName</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="sb">`Pane[2]/Pane/Pane/Pane/Pane[1]/Pane/Pane/Pane/Pane/Pane/Pane/Pane/Pane[2]/List/List/ListItem[</span><span class="si">${</span><span class="nx">i</span><span class="si">}</span><span class="sb">]`</span><span class="p">);</span><span class="c1">//模板字符串</span>
<span class="w">    </span><span class="k">if</span><span class="p">(</span><span class="nx">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span>
<span class="w">        </span><span class="k">break</span><span class="p">;</span>

<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
<span class="p">}</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getElementValue</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">);</span>
<span class="c1">// 获取元素文本</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 成功返回元素文本，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getElementRect</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">);</span>
<span class="c1">// 获取元素矩形大小</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄。如果是java窗口并且窗口句柄和元素句柄不一致，需要使用getElementWindow获取窗口句柄。</span>
<span class="c1">// getElementWindow参数的xpath，Aibote Tool应当使用正常模式下获取的XPATH路径，不要 “勾选java窗口” 复选按钮。对话框子窗口，需要获取对应的窗口句柄操作</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 成功返回{left:number, top:number, right:number, bottom:number}，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getElementWindow</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">);</span>
<span class="c1">// 获取元素窗口句柄</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 成功返回窗口句柄，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">clickElement</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">,</span><span class="w"> </span><span class="nx">msg</span><span class="p">);</span>
<span class="c1">// 点击元素</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄。如果是java窗口并且窗口句柄和元素句柄不一致，需要使用getElementWindow获取窗口句柄。</span>
<span class="c1">// getElementWindow参数的xpath，Aibote Tool应当使用正常模式下获取的XPATH路径，不要 “勾选java窗口” 复选按钮。对话框子窗口，需要获取对应的窗口句柄操作</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 参数三 整型，点击类型，单击左键:1 单击右键:2 按下左键:3 弹起左键:4 按下右键:5 弹起右键:6 双击左键:7 双击右键:8</span>
<span class="c1">// 成功返回true 失败返回 false。如果此函数不能点击，可尝试使用invokeElement函数</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">invokeElement</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">);</span>
<span class="c1">// 执行元素默认操作(一般是点击操作)</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄。</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 成功返回true 失败返回 false。</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">setElementFocus</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">);</span>
<span class="c1">// 设置元素作为焦点</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 成功返回true 失败返回 false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">setElementValue</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">);</span>
<span class="c1">// 设置元素文本</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄。如果是java窗口并且窗口句柄和元素句柄不一致，需要使用getElementWindow获取窗口句柄。</span>
<span class="c1">// getElementWindow参数的xpath，Aibote Tool应当使用正常模式下获取的XPATH路径，不要 “勾选java窗口” 复选按钮。对话框子窗口，需要获取对应的窗口句柄操作</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 参数三 字符串型，要设置的内容</span>
<span class="c1">// 成功返回true 失败返回 false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">setElementScroll</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">,</span><span class="w"> </span><span class="nx">horizontalPercent</span><span class="p">,</span><span class="w"> </span><span class="nx">verticalPercent</span><span class="p">);</span>
<span class="c1">// 滚动元素</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 参数三 整型，水平百分比 -1不滚动</span>
<span class="c1">// 参数四 整型，垂直百分比 -1不滚动</span>
<span class="c1">// 成功返回true 失败返回 false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">isSelected</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">);</span>
<span class="c1">// 单/复选框是否选中</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 成功返回true 失败返回 false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">closeWindow</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">);</span>
<span class="c1">// 关闭窗口</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄。如果是java窗口并且窗口句柄和元素句柄不一致，需要使用getElementWindow获取窗口句柄。</span>
<span class="c1">// getElementWindow参数的xpath，Aibote Tool应当使用正常模式下获取的XPATH路径，不要 “勾选java窗口” 复选按钮。对话框子窗口，需要获取对应的窗口句柄操作</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 成功返回true 失败返回 false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">setWindowState</span><span class="p">(</span><span class="nx">hwnd</span><span class="p">,</span><span class="w"> </span><span class="nx">xpath</span><span class="p">,</span><span class="w"> </span><span class="nx">state</span><span class="p">);</span>
<span class="c1">// 设置窗口状态</span>
<span class="c1">// 参数一 字符串/整型，窗口句柄。如果是java窗口并且窗口句柄和元素句柄不一致，需要使用getElementWindow获取窗口句柄。</span>
<span class="c1">// getElementWindow参数的xpath，Aibote Tool应当使用正常模式下获取的XPATH路径，不要 “勾选java窗口” 复选按钮。对话框子窗口，需要获取对应的窗口句柄操作</span>
<span class="c1">// 参数二 字符串型，元素路径</span>
<span class="c1">// 参数三 整型，0正常 1最大化 2 最小化</span>
<span class="c1">// 成功返回true 失败返回 false</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-9-9-1" class="sphinx-tabs-panel" hidden="true" id="panel-9-9-1" name="9-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id10">
<h2>系统剪切板<a class="headerlink" href="#id10" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-10-10-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-10-10-0" name="10-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-10-10-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-10-10-1" name="10-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-10-10-0" class="sphinx-tabs-panel" id="panel-10-10-0" name="10-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">setClipboardText</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>
<span class="c1">// 设置剪切板内容</span>
<span class="c1">// 参数一 字符串型，设置的文本</span>
<span class="c1">// 成功返回true 失败返回 false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getClipboardText</span><span class="p">();</span>
<span class="c1">// 获取剪切板内容</span>
<span class="c1">// 返回剪切板文本</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-10-10-1" class="sphinx-tabs-panel" hidden="true" id="panel-10-10-1" name="10-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id11">
<h2>启动进程<a class="headerlink" href="#id11" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-11-11-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-11-11-0" name="11-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-11-11-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-11-11-1" name="11-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-11-11-0" class="sphinx-tabs-panel" id="panel-11-11-0" name="11-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">startProcess</span><span class="p">(</span><span class="nx">commandLine</span><span class="p">,</span><span class="w"> </span><span class="nx">showWindow</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nx">isWait</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="c1">// 参数一 字符串型，启动命令行</span>
<span class="c1">// 参数二 布尔型，是否显示窗口。可选参数,默认显示窗口</span>
<span class="c1">// 参数三 布尔型，是否等待程序结束。可选参数,默认不等待</span>
<span class="c1">// 成功返回true,失败返回false</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 后台启动应用程序</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">startProcess</span><span class="p">(</span><span class="s2">&quot;d:\\Aibote\\Aibote.exe&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="c1">// 启动cmd.exe 指定启动参数</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">startProcess</span><span class="p">(</span><span class="s2">&quot;cmd.exe netstat-an&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>

<span class="c1">// 启动cmd.exe 指定启动参数并且等待进程关闭</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">startProcess</span><span class="p">(</span><span class="s2">&quot;cmd.exe netstat-an&quot;</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="kc">true</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-11-11-1" class="sphinx-tabs-panel" hidden="true" id="panel-11-11-1" name="11-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="cmd">
<h2>执行cmd命令<a class="headerlink" href="#cmd" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-12-12-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-12-12-0" name="12-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-12-12-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-12-12-1" name="12-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-12-12-0" class="sphinx-tabs-panel" id="panel-12-12-0" name="12-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">executeCommand</span><span class="p">(</span><span class="nx">command</span><span class="p">,</span><span class="w"> </span><span class="nx">waitTimeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">300</span><span class="p">);</span>
<span class="c1">// 此函数用于获取cmd执行结果，函数执行完毕会自动关闭启动的相关进程</span>
<span class="c1">// 参数一 字符串型，cmd命令，不能含 &quot;cmd&quot;字串</span>
<span class="c1">// 参数二 整型，可选参数，等待结果返回超时，单位毫秒，默认300毫秒</span>
<span class="c1">// 返回cmd执行结果</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 执行cmd 等待3000毫秒返回结果</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">executeCommand</span><span class="p">(</span><span class="s2">&quot;ping www.baidu.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">3000</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-12-12-1" class="sphinx-tabs-panel" hidden="true" id="panel-12-12-1" name="12-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="url">
<h2>指定url下载文件<a class="headerlink" href="#url" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-13-13-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-13-13-0" name="13-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-13-13-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-13-13-1" name="13-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-13-13-0" class="sphinx-tabs-panel" id="panel-13-13-0" name="13-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">downloadFile</span><span class="p">(</span><span class="nx">url</span><span class="p">,</span><span class="w"> </span><span class="nx">filePath</span><span class="p">,</span><span class="w"> </span><span class="nx">isWait</span><span class="p">);</span>
<span class="c1">// 参数一 字符串型，文件地址</span>
<span class="c1">// 参数二 字符串型，文件保存的路径</span>
<span class="c1">// 参数三 布尔型，是否等待.为true时,等待下载完成</span>
<span class="c1">// 总是返回true</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-13-13-1" class="sphinx-tabs-panel" hidden="true" id="panel-13-13-1" name="13-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="excel">
<h2>Excel文档<a class="headerlink" href="#excel" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-14-14-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-14-14-0" name="14-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-14-14-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-14-14-1" name="14-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-14-14-0" class="sphinx-tabs-panel" id="panel-14-14-0" name="14-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">openExcel</span><span class="p">(</span><span class="nx">excelPath</span><span class="p">);</span>
<span class="c1">// 打开excel文档</span>
<span class="c1">// 参数一 字符串，excle路径</span>
<span class="c1">// 成功返回excel对象，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">openExcelSheet</span><span class="p">(</span><span class="nx">excelObject</span><span class="p">,</span><span class="w"> </span><span class="nx">sheetName</span><span class="p">);</span>
<span class="c1">// 打开excel表格</span>
<span class="c1">// 参数一 对象，excel对象</span>
<span class="c1">// 参数二 字符串，表名</span>
<span class="c1">// 成功返回sheet对象，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">saveExcel</span><span class="p">(</span><span class="nx">excelObject</span><span class="p">);</span>
<span class="c1">// 保存/关闭excel文档</span>
<span class="c1">// 参数一 对象，excel对象</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">writeExcelNum</span><span class="p">(</span><span class="nx">sheetObject</span><span class="p">,</span><span class="w"> </span><span class="nx">row</span><span class="p">,</span><span class="w"> </span><span class="nx">col</span><span class="p">,</span><span class="w"> </span><span class="nx">value</span><span class="p">);</span>
<span class="c1">// 写入数字到excel表格</span>
<span class="c1">// 参数一 对象，sheet对象</span>
<span class="c1">// 参数二 整型，行</span>
<span class="c1">// 参数三 整型，列</span>
<span class="c1">// 参数四 数字型，写入的值</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">writeExcelStr</span><span class="p">(</span><span class="nx">sheetObject</span><span class="p">,</span><span class="w"> </span><span class="nx">row</span><span class="p">,</span><span class="w"> </span><span class="nx">col</span><span class="p">,</span><span class="w"> </span><span class="nx">strValue</span><span class="p">);</span>
<span class="c1">// 写入字串到excel表格</span>
<span class="c1">// 参数一 对象，sheet对象</span>
<span class="c1">// 参数二 整型，行</span>
<span class="c1">// 参数三 整型，列</span>
<span class="c1">// 参数四 字符串，写入的值</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">readExcelNum</span><span class="p">(</span><span class="nx">sheetObject</span><span class="p">,</span><span class="w"> </span><span class="nx">row</span><span class="p">,</span><span class="w"> </span><span class="nx">col</span><span class="p">);</span>
<span class="c1">// 读取excel表格数字</span>
<span class="c1">// 参数一 对象，sheet对象</span>
<span class="c1">// 参数二 整型，行</span>
<span class="c1">// 参数三 整型，列</span>
<span class="c1">// 返回读取到的数字</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">readExcelStr</span><span class="p">(</span><span class="nx">sheetObject</span><span class="p">,</span><span class="w"> </span><span class="nx">row</span><span class="p">,</span><span class="w"> </span><span class="nx">col</span><span class="p">);</span>
<span class="c1">// 读取excel表格字串</span>
<span class="c1">// 参数一 对象，sheet对象</span>
<span class="c1">// 参数二 整型，行</span>
<span class="c1">// 参数三 整型，列</span>
<span class="c1">// 返回读取到的字符</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">removeExcelRow</span><span class="p">(</span><span class="nx">sheetObject</span><span class="p">,</span><span class="w"> </span><span class="nx">rowFirst</span><span class="p">,</span><span class="w"> </span><span class="nx">rowLast</span><span class="p">);</span>
<span class="c1">// 删除excel表格行</span>
<span class="c1">// 参数一 对象，sheet对象</span>
<span class="c1">// 参数二 整型，起始行</span>
<span class="c1">// 参数三 整型，结束行</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">removeExcelCol</span><span class="p">(</span><span class="nx">sheetObject</span><span class="p">,</span><span class="w"> </span><span class="nx">colFirst</span><span class="p">,</span><span class="w"> </span><span class="nx">colLast</span><span class="p">);</span>
<span class="c1">// 删除excel表格列</span>
<span class="c1">// 参数一 对象，sheet对象</span>
<span class="c1">// 参数二 整型，起始列</span>
<span class="c1">// 参数三 整型，结束列</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 打开excel</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">excelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;d:\\1.xlsx&quot;</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">excelObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">openExcel</span><span class="p">(</span><span class="nx">excelPath</span><span class="p">);</span>

<span class="c1">// 打开/创建表</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">sheetName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;第1张表&quot;</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">sheetObject</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">openExcelSheet</span><span class="p">(</span><span class="nx">excelObject</span><span class="p">,</span><span class="w"> </span><span class="nx">sheetName</span><span class="p">);</span>

<span class="c1">// 写入字符串到第一个表格</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">writeExcelStr</span><span class="p">(</span><span class="nx">sheetObject</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;aibote RPA&quot;</span><span class="p">);</span>

<span class="c1">// 读取第一个表格内容</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">readExcelStr</span><span class="p">(</span><span class="nx">sheetObject</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">text</span><span class="p">);</span>

<span class="c1">// 保存/关闭excel。如果再次操作需要重新调用openExcel、openExcelSheet 函数</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">saveExcel</span><span class="p">(</span><span class="nx">excelObject</span><span class="p">);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-14-14-1" class="sphinx-tabs-panel" hidden="true" id="panel-14-14-1" name="14-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id12">
<h2>验证码系统<a class="headerlink" href="#id12" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-15-15-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-15-15-0" name="15-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-15-15-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-15-15-1" name="15-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-15-15-0" class="sphinx-tabs-panel" id="panel-15-15-0" name="15-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">getCaptcha</span><span class="p">(</span><span class="nx">filePath</span><span class="p">,</span><span class="w"> </span><span class="nx">username</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="p">,</span><span class="w"> </span><span class="nx">softId</span><span class="p">,</span><span class="w"> </span><span class="nx">codeType</span><span class="p">,</span><span class="w"> </span><span class="nx">lenMin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="c1">// 识别验证码</span>
<span class="c1">// 参数一 字符串类型，图片文件路径</span>
<span class="c1">// 参数二 字符串类型，用户名</span>
<span class="c1">// 参数三 字符串类型，密码</span>
<span class="c1">// 参数四 字符串类型，软件ID</span>
<span class="c1">// 参数四 字符串类型，图片类型 参考https:// www.chaojiying.com/price.html</span>
<span class="c1">// 参数五 字符串类型，最小位数 默认0为不启用,图片类型为可变位长时可启用这个参数</span>
<span class="c1">// 返回JSON类型{{err_no:number, err_str:string, pic_id:string, pic_str:string, md5:string}}</span>
<span class="c1">// err_no,(数值) 返回代码  为0 表示正常，错误代码 参考https:// www.chaojiying.com/api-23.html</span>
<span class="c1">// err_str,(字符串) 中文描述的返回信息</span>
<span class="c1">// pic_id,(字符串) 图片标识号，或图片id号</span>
<span class="c1">// pic_str,(字符串) 识别出的结果</span>
<span class="c1">// md5,(字符串) md5校验值,用来校验此条数据返回是否真实有效</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 通过超级鹰第三方平台接口，识别验证码。username, password, softId由第三方平台提供</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">filePath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;d:\\1.png&quot;</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">androidBot</span><span class="p">.</span><span class="nx">getCaptcha</span><span class="p">(</span><span class="nx">filePath</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;username&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;password&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;123456&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;1902&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nx">code</span><span class="p">[</span><span class="s2">&quot;err_no&quot;</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mf">0</span><span class="p">)</span><span class="c1">// 没有错误信息，输出识别结果</span>
<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">code</span><span class="p">[</span><span class="s2">&quot;pic_str&quot;</span><span class="p">]);</span>


<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">errorCaptcha</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="p">,</span><span class="w"> </span><span class="nx">softId</span><span class="p">,</span><span class="w"> </span><span class="nx">picId</span><span class="p">);</span>
<span class="c1">// 识别报错返分</span>
<span class="c1">// 参数一 字符串类型，用户名</span>
<span class="c1">// 参数二 字符串类型，密码</span>
<span class="c1">// 参数三 字符串类型，软件ID</span>
<span class="c1">// 参数四 字符串类型，图片ID 对应 getCaptcha返回值的pic_id 字段</span>
<span class="c1">// 返回JSON类型{{err_no:number, err_str:string}}</span>
<span class="c1">// err_no,(数值) 返回代码</span>
<span class="c1">// err_str,(字符串) 中文描述的返回信息</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">scoreCaptcha</span><span class="p">(</span><span class="nx">username</span><span class="p">,</span><span class="w"> </span><span class="nx">password</span><span class="p">);</span>
<span class="c1">// 查询验证码剩余题分</span>
<span class="c1">// 参数一 字符串类型，用户名</span>
<span class="c1">// 参数二 字符串类型，密码</span>
<span class="c1">// 返回JSON类型{{err_no:number, err_str:string, tifen:string, tifen_lock:string}}</span>
<span class="c1">// err_no,(数值) 返回代码</span>
<span class="c1">// err_str,(字符串) 中文描述的返回信息</span>
<span class="c1">// tifen,(数值) 题分</span>
<span class="c1">// tifen_lock,(数值) 锁定题分</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-15-15-1" class="sphinx-tabs-panel" hidden="true" id="panel-15-15-1" name="15-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="nlp">
<h2>自然语言处理(NLP)<a class="headerlink" href="#nlp" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-16-16-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-16-16-0" name="16-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-16-16-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-16-16-1" name="16-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-16-16-0" class="sphinx-tabs-panel" id="panel-16-16-0" name="16-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="c1">// 初始化NLP</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">initNLP</span><span class="p">(</span><span class="nx">aipKey</span><span class="p">);</span>
<span class="c1">// 初始化NLP</span>
<span class="c1">// 参数一 字符串型，密钥</span>
<span class="c1">// 成功返回true，失败返回false</span>


<span class="c1">// chatgpt的使用</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgpt</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span><span class="w"> </span><span class="nx">prompt</span><span class="p">,</span><span class="w"> </span><span class="nx">maxTokens</span><span class="p">,</span><span class="w"> </span><span class="nx">temperature</span><span class="p">,</span><span class="w"> </span><span class="nx">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="c1">// 使用chatgpt</span>
<span class="c1">// 参数一 字符串型，指定使用的模型,&quot;text-davinci-003&quot;、text-curie-001、text-babbage-001、text-ada-001和自定义微调模型</span>
<span class="c1">// 参数二 字符串型，提出的问题</span>
<span class="c1">// 参数三 最大令牌书，大约 3个字符1个令牌，1个汉字2个令牌</span>
<span class="c1">// 参数四 浮点型，调节结果的创意程度，0为单一结果， 1创意度更高</span>
<span class="c1">// 参数五 字符串型，可选参数，停止结果输出标志，一般用在微调模型上，例如 stop = &#39;[&quot;END&quot;]&#39;</span>
<span class="c1">// 返回json类型，{{text:string, finish:boolean} || null}</span>
<span class="c1">// text 返回的答案内容</span>
<span class="c1">// finish 为true回答结束，false 还有未输出的答案。我们可以继续 prompt + 输出的答案 获取后续内容，直到finish为true</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgptEdit</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span><span class="w"> </span><span class="nx">input</span><span class="p">,</span><span class="w"> </span><span class="nx">instruction</span><span class="p">,</span><span class="w"> </span><span class="nx">maxTokens</span><span class="p">,</span><span class="w"> </span><span class="nx">temperature</span><span class="p">);</span>
<span class="c1">// 使用chatgpt编辑模式</span>
<span class="c1">// 参数一 字符串型，指定使用的模型,&quot;text-davinci-edit-001&quot;、&quot;code-davinci-edit-001&quot;</span>
<span class="c1">// 参数二 字符串型，要编辑的文本</span>
<span class="c1">// 参数三 字符串型，提示如何去编辑修改</span>
<span class="c1">// 参数四 最大令牌书，大约 3个字符1个令牌，1个汉字2个令牌</span>
<span class="c1">// 参数五 浮点型，调节结果的创意程度，0为单一结果， 1创意度更高</span>
<span class="c1">// 返回json类型，{{text:string, finish:boolean} || null}</span>
<span class="c1">// text 返回的答案内容</span>
<span class="c1">// finish 为true回答结束，false 还有未输出的答案。我们可以继续 prompt + 输出的答案 获取后续内容，直到finish为true</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 初始化</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">bRet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">initNLP</span><span class="p">(</span><span class="s2">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">bRet</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// return;</span>

<span class="c1">// chatgpt</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgpt</span><span class="p">(</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;怎么称呼你？&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">256</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span>

<span class="c1">// chatgpt 循环获取答案</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;请介绍下Aibote的应用场景，不少于500字&quot;</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">isFinish</span><span class="p">;</span>
<span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgpt</span><span class="p">(</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">prompt</span><span class="p">,</span><span class="w"> </span><span class="mf">256</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">);</span>
<span class="w">    </span><span class="nx">isFinish</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;finish&quot;</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isFinish</span><span class="p">)</span>
<span class="w">        </span><span class="nx">prompt</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">];</span>

<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span>
<span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isFinish</span><span class="p">)</span>

<span class="c1">// chatgptEdit</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgptEdit</span><span class="p">(</span><span class="s2">&quot;text-davinci-edit-001&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;你好码？&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;修正错误文字&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">256</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span>


<span class="c1">// 训练模型</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">createFineTune</span><span class="p">(</span><span class="nx">fileId</span><span class="p">,</span><span class="w"> </span><span class="nx">baseModel</span><span class="p">,</span><span class="w"> </span><span class="nx">suffix</span><span class="p">);</span>
<span class="c1">// 创建微调模型</span>
<span class="c1">// 参数一 字符串型，文件id，可通过 uploadTrainFile函数上传并获取文件id</span>
<span class="c1">// 参数二 字符串型，基础模型，可以是以下参数之一，&quot;ada&quot;, &quot;babbage&quot;, &quot;curie&quot;, &quot;davinci&quot;和自定义微调模型</span>
<span class="c1">// 参数三 字符串型  微调生成的模型名称后缀，不建议使用中文</span>
<span class="c1">// 成功返回微调id，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">listFineTunes</span><span class="p">();</span>
<span class="c1">// 列出所有微调信息</span>
<span class="c1">// 返回json对象数组 {[{baseModel:string, object:string, fineTuneId:string, fineTunedModel:string, fineTuneStatus:string, fileName:string, fileId:strinig, fileStatus:string}, ...] || null}</span>
<span class="c1">// baseModel 基础模型，一般是&quot;ada&quot;, &quot;babbage&quot;, &quot;curie&quot;, &quot;davinci&quot;</span>
<span class="c1">// object</span>
<span class="c1">// fineTuneId 微调id</span>
<span class="c1">// fineTunedModel 微调模型的名称</span>
<span class="c1">// fineTuneStatus 正在微调模型的进度状态</span>
<span class="c1">// fileName 训练数据文件的名称</span>
<span class="c1">// fileId 训练数据文件的id</span>
<span class="c1">// fileStatus 训练数据文件的状态</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">listFineTune</span><span class="p">(</span><span class="nx">fineTuneId</span><span class="p">);</span>
<span class="c1">// 获取指定微调id的详细信息</span>
<span class="c1">// 参数一 字符串型 微调id</span>
<span class="c1">// 返回json对象 {{baseModel:string, fineTuneCosts:string, fineTunedModel:string, fineTuneStatus:string, fileName:string, fileId:string,  fileStatus:string} || null}</span>
<span class="c1">// baseModel 基础模型，一般是&quot;ada&quot;, &quot;babbage&quot;, &quot;curie&quot;, &quot;davinci&quot;</span>
<span class="c1">// fineTuneCosts 训练该模型消耗的$</span>
<span class="c1">// fineTunedModel 微调模型的名称</span>
<span class="c1">// fineTuneStatus 正在微调模型的进度状态</span>
<span class="c1">// fileName 训练数据文件的名称</span>
<span class="c1">// fileId 训练数据文件的id</span>
<span class="c1">// fileStatus 训练数据文件的状态</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">cancelFineTune</span><span class="p">(</span><span class="nx">fineTuneId</span><span class="p">);</span>
<span class="c1">// 取消正在微调的作业</span>
<span class="c1">// 参数一 字符串型, 微调id</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">deleteFineTuneModel</span><span class="p">(</span><span class="nx">fineTuneId</span><span class="p">);</span>
<span class="c1">// 删除微调模型</span>
<span class="c1">// 参数一 字符串型, 微调id</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="c1">// 训练数据文件</span>
<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">uploadTrainFile</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
<span class="c1">// 上传训练文件到服务器</span>
<span class="c1">// 参数一 字符串型, 文件路径，不支持中文路径</span>
<span class="c1">// 成功返回文件id，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">listTrainFiles</span><span class="p">();</span>
<span class="c1">// 列出所有训练文件信息</span>
<span class="c1">// 返回json对象数组 {Promise.&lt;[{bytes:number, fileName:string, fileId:string, purpose:string}] || null&gt;}</span>
<span class="c1">// bytes 训练数据文件的大小</span>
<span class="c1">// fileName 训练数据文件的名称</span>
<span class="c1">// fileId 训练数据文件的id</span>
<span class="c1">// purpose 文件的意图 例如：&quot;fine-tune&quot; 意图为 用作微调模型</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">listTrainFile</span><span class="p">(</span><span class="nx">fileId</span><span class="p">);</span>
<span class="c1">// 参数一 字符串型， 文件id</span>
<span class="c1">// 返回json对象 {Promise.&lt;{bytes:number, fileName:string, fileId:string, purpose:string} || null&gt;}</span>
<span class="c1">// bytes 训练数据文件的大小</span>
<span class="c1">// fileName 训练数据文件的名称</span>
<span class="c1">// fileId 训练数据文件的id</span>
<span class="c1">// purpose 文件的意图 例如：&quot;fine-tune&quot; 意图为 用作微调模型</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">downloadTrainFile</span><span class="p">(</span><span class="nx">fileId</span><span class="p">);</span>
<span class="c1">// 下载训练文件内容</span>
<span class="c1">// 参数一 字符串型， =文件id</span>
<span class="c1">// 成功返回文件内容，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">deleteTrainFile</span><span class="p">(</span><span class="nx">fileId</span><span class="p">);</span>
<span class="c1">// 删除训练文件</span>
<span class="c1">// 参数一 字符串型， =文件id</span>
<span class="c1">// 成功返回文件内容，失败返回null</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-16-16-1" class="sphinx-tabs-panel" hidden="true" id="panel-16-16-1" name="16-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
<section id="id13">
<h3>初始化NLP<a class="headerlink" href="#id13" title="此标题的永久链接">#</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-17-17-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-17-17-0" name="17-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-17-17-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-17-17-1" name="17-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-17-17-0" class="sphinx-tabs-panel" id="panel-17-17-0" name="17-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">initNLP</span><span class="p">(</span><span class="nx">aipKey</span><span class="p">);</span>
<span class="c1">//初始化NLP</span>
<span class="c1">//参数一 字符串型，密钥</span>
<span class="c1">//成功返回true，失败返回false</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-17-17-1" class="sphinx-tabs-panel" hidden="true" id="panel-17-17-1" name="17-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="chatgpt">
<h3>chatGPT的使用<a class="headerlink" href="#chatgpt" title="此标题的永久链接">#</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-18-18-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-18-18-0" name="18-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-18-18-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-18-18-1" name="18-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-18-18-0" class="sphinx-tabs-panel" id="panel-18-18-0" name="18-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgpt</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span><span class="w"> </span><span class="nx">prompt</span><span class="p">,</span><span class="w"> </span><span class="nx">maxTokens</span><span class="p">,</span><span class="w"> </span><span class="nx">temperature</span><span class="p">,</span><span class="w"> </span><span class="nx">stop</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;&quot;</span><span class="p">);</span>
<span class="c1">// 使用chatgpt</span>
<span class="c1">// 参数一 字符串型，指定使用的模型,&quot;text-davinci-003&quot;、text-curie-001、text-babbage-001、text-ada-001和自定义微调模型</span>
<span class="c1">// 参数二 字符串型，提出的问题</span>
<span class="c1">// 参数三 最大令牌书，大约 3个字符1个令牌，1个汉字2个令牌</span>
<span class="c1">// 参数四 浮点型，调节结果的创意程度，0为单一结果， 1创意度更高</span>
<span class="c1">// 参数五 字符串型，可选参数，停止结果输出标志，一般用在微调模型上，例如 stop = &#39;[&quot;END&quot;]&#39;</span>
<span class="c1">// 返回json类型，{{text:string, finish:boolean} || null}</span>
<span class="c1">// text 返回的答案内容</span>
<span class="c1">// finish 为true回答结束，false 还有未输出的答案。我们可以继续 prompt + 输出的答案 获取后续内容，直到finish为true</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgptEdit</span><span class="p">(</span><span class="nx">model</span><span class="p">,</span><span class="w"> </span><span class="nx">input</span><span class="p">,</span><span class="w"> </span><span class="nx">instruction</span><span class="p">,</span><span class="w"> </span><span class="nx">maxTokens</span><span class="p">,</span><span class="w"> </span><span class="nx">temperature</span><span class="p">);</span>
<span class="c1">// 使用chatgpt编辑模式</span>
<span class="c1">// 参数一 字符串型，指定使用的模型,&quot;text-davinci-edit-001&quot;、&quot;code-davinci-edit-001&quot;</span>
<span class="c1">// 参数二 字符串型，要编辑的文本</span>
<span class="c1">// 参数三 字符串型，提示如何去编辑修改</span>
<span class="c1">// 参数四 最大令牌书，大约 3个字符1个令牌，1个汉字2个令牌</span>
<span class="c1">// 参数五 浮点型，调节结果的创意程度，0为单一结果， 1创意度更高</span>
<span class="c1">// 返回json类型，{{text:string, finish:boolean} || null}</span>
<span class="c1">// text 返回的答案内容</span>
<span class="c1">// finish 为true回答结束，false 还有未输出的答案。我们可以继续 prompt + 输出的答案 获取后续内容，直到finish为true</span>

<span class="c1">// 代码示例</span>
<span class="c1">// 初始化</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">bRet</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">initNLP</span><span class="p">(</span><span class="s2">&quot;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx&quot;</span><span class="p">);</span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">bRet</span><span class="p">)</span>
<span class="w">    </span><span class="c1">// return;</span>

<span class="c1">// chatgpt</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgpt</span><span class="p">(</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;怎么称呼你？&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">256</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span>

<span class="c1">// chatgpt 循环获取答案</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">prompt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;请介绍下Aibote的应用场景，不少于500字&quot;</span><span class="p">;</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">isFinish</span><span class="p">;</span>
<span class="k">do</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgpt</span><span class="p">(</span><span class="s2">&quot;text-davinci-003&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">prompt</span><span class="p">,</span><span class="w"> </span><span class="mf">256</span><span class="p">,</span><span class="w"> </span><span class="mf">0.7</span><span class="p">);</span>
<span class="w">    </span><span class="nx">isFinish</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;finish&quot;</span><span class="p">];</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isFinish</span><span class="p">)</span>
<span class="w">        </span><span class="nx">prompt</span><span class="w"> </span><span class="o">+=</span><span class="w"> </span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">];</span>

<span class="w">    </span><span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span>
<span class="p">}</span><span class="w"> </span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="nx">isFinish</span><span class="p">)</span>

<span class="c1">// chatgptEdit</span>
<span class="kd">let</span><span class="w"> </span><span class="nx">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">chatgptEdit</span><span class="p">(</span><span class="s2">&quot;text-davinci-edit-001&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;你好码？&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;修正错误文字&quot;</span><span class="p">,</span><span class="w"> </span><span class="mf">256</span><span class="p">,</span><span class="w"> </span><span class="mf">0</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">result</span><span class="p">[</span><span class="s2">&quot;text&quot;</span><span class="p">]);</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-18-18-1" class="sphinx-tabs-panel" hidden="true" id="panel-18-18-1" name="18-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id14">
<h3>训练模型<a class="headerlink" href="#id14" title="此标题的永久链接">#</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-19-19-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-19-19-0" name="19-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-19-19-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-19-19-1" name="19-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-19-19-0" class="sphinx-tabs-panel" id="panel-19-19-0" name="19-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">createFineTune</span><span class="p">(</span><span class="nx">fileId</span><span class="p">,</span><span class="w"> </span><span class="nx">baseModel</span><span class="p">,</span><span class="w"> </span><span class="nx">suffix</span><span class="p">);</span>
<span class="c1">// 创建微调模型</span>
<span class="c1">// 参数一 字符串型，文件id，可通过 uploadTrainFile函数上传并获取文件id</span>
<span class="c1">// 参数二 字符串型，基础模型，可以是以下参数之一，&quot;ada&quot;, &quot;babbage&quot;, &quot;curie&quot;, &quot;davinci&quot;和自定义微调模型</span>
<span class="c1">// 参数三 字符串型  微调生成的模型名称后缀，不建议使用中文</span>
<span class="c1">// 成功返回微调id，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">listFineTunes</span><span class="p">();</span>
<span class="c1">// 列出所有微调信息</span>
<span class="c1">// 返回json对象数组 {[{baseModel:string, object:string, fineTuneId:string, fineTunedModel:string, fineTuneStatus:string, fileName:string, fileId:strinig, fileStatus:string}, ...] || null}</span>
<span class="c1">// baseModel 基础模型，一般是&quot;ada&quot;, &quot;babbage&quot;, &quot;curie&quot;, &quot;davinci&quot;</span>
<span class="c1">// object</span>
<span class="c1">// fineTuneId 微调id</span>
<span class="c1">// fineTunedModel 微调模型的名称</span>
<span class="c1">// fineTuneStatus 正在微调模型的进度状态</span>
<span class="c1">// fileName 训练数据文件的名称</span>
<span class="c1">// fileId 训练数据文件的id</span>
<span class="c1">// fileStatus 训练数据文件的状态</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">listFineTune</span><span class="p">(</span><span class="nx">fineTuneId</span><span class="p">);</span>
<span class="c1">// 获取指定微调id的详细信息</span>
<span class="c1">// 参数一 字符串型 微调id</span>
<span class="c1">// 返回json对象 {{baseModel:string, fineTuneCosts:string, fineTunedModel:string, fineTuneStatus:string, fileName:string, fileId:string,  fileStatus:string} || null}</span>
<span class="c1">// baseModel 基础模型，一般是&quot;ada&quot;, &quot;babbage&quot;, &quot;curie&quot;, &quot;davinci&quot;</span>
<span class="c1">// fineTuneCosts 训练该模型消耗的$</span>
<span class="c1">// fineTunedModel 微调模型的名称</span>
<span class="c1">// fineTuneStatus 正在微调模型的进度状态</span>
<span class="c1">// fileName 训练数据文件的名称</span>
<span class="c1">// fileId 训练数据文件的id</span>
<span class="c1">// fileStatus 训练数据文件的状态</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">cancelFineTune</span><span class="p">(</span><span class="nx">fineTuneId</span><span class="p">);</span>
<span class="c1">// 取消正在微调的作业</span>
<span class="c1">// 参数一 字符串型, 微调id</span>
<span class="c1">// 成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">deleteFineTuneModel</span><span class="p">(</span><span class="nx">fineTuneId</span><span class="p">);</span>
<span class="c1">// 删除微调模型</span>
<span class="c1">// 参数一 字符串型, 微调id</span>
<span class="c1">// 成功返回true，失败返回false</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-19-19-1" class="sphinx-tabs-panel" hidden="true" id="panel-19-19-1" name="19-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id15">
<h3>训练数据文件<a class="headerlink" href="#id15" title="此标题的永久链接">#</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-20-20-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-20-20-0" name="20-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-20-20-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-20-20-1" name="20-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-20-20-0" class="sphinx-tabs-panel" id="panel-20-20-0" name="20-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">uploadTrainFile</span><span class="p">(</span><span class="nx">filePath</span><span class="p">);</span>
<span class="c1">// 上传训练文件到服务器</span>
<span class="c1">// 参数一 字符串型, 文件路径，不支持中文路径</span>
<span class="c1">// 成功返回文件id，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">listTrainFiles</span><span class="p">();</span>
<span class="c1">// 列出所有训练文件信息</span>
<span class="c1">// 返回json对象数组 {Promise.&lt;[{bytes:number, fileName:string, fileId:string, purpose:string}] || null&gt;}</span>
<span class="c1">// bytes 训练数据文件的大小</span>
<span class="c1">// fileName 训练数据文件的名称</span>
<span class="c1">// fileId 训练数据文件的id</span>
<span class="c1">// purpose 文件的意图 例如：&quot;fine-tune&quot; 意图为 用作微调模型</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">listTrainFile</span><span class="p">(</span><span class="nx">fileId</span><span class="p">);</span>
<span class="c1">// 参数一 字符串型， 文件id</span>
<span class="c1">// 返回json对象 {Promise.&lt;{bytes:number, fileName:string, fileId:string, purpose:string} || null&gt;}</span>
<span class="c1">// bytes 训练数据文件的大小</span>
<span class="c1">// fileName 训练数据文件的名称</span>
<span class="c1">// fileId 训练数据文件的id</span>
<span class="c1">// purpose 文件的意图 例如：&quot;fine-tune&quot; 意图为 用作微调模型</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">downloadTrainFile</span><span class="p">(</span><span class="nx">fileId</span><span class="p">);</span>
<span class="c1">// 下载训练文件内容</span>
<span class="c1">// 参数一 字符串型， =文件id</span>
<span class="c1">// 成功返回文件内容，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">deleteTrainFile</span><span class="p">(</span><span class="nx">fileId</span><span class="p">);</span>
<span class="c1">// 删除训练文件</span>
<span class="c1">// 参数一 字符串型， =文件id</span>
<span class="c1">// 成功返回文件内容，失败返回null</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-20-20-1" class="sphinx-tabs-panel" hidden="true" id="panel-20-20-1" name="20-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
</section>
<section id="id16">
<h2>语音合成/识别服务<a class="headerlink" href="#id16" title="此标题的永久链接">#</a></h2>
<section id="id17">
<h3>初始化语音服务<a class="headerlink" href="#id17" title="此标题的永久链接">#</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-21-21-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-21-21-0" name="21-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-21-21-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-21-21-1" name="21-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-21-21-0" class="sphinx-tabs-panel" id="panel-21-21-0" name="21-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">initSpeechService</span><span class="p">(</span><span class="nx">speechKey</span><span class="p">,</span><span class="w"> </span><span class="nx">speechRegion</span><span class="p">);</span>
<span class="c1">//初始化语音服务</span>
<span class="c1">//参数一 字符串型，密钥</span>
<span class="c1">//参数二 字符串型，区域</span>
<span class="c1">//总是返回true</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-21-21-1" class="sphinx-tabs-panel" hidden="true" id="panel-21-21-1" name="21-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id18">
<h3>语音识别<a class="headerlink" href="#id18" title="此标题的永久链接">#</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-22-22-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-22-22-0" name="22-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-22-22-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-22-22-1" name="22-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-22-22-0" class="sphinx-tabs-panel" id="panel-22-22-0" name="22-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">audioFileToText</span><span class="p">(</span><span class="nx">filePath</span><span class="p">,</span><span class="w"> </span><span class="nx">language</span><span class="p">);</span>
<span class="c1">// 音频文件转文本</span>
<span class="c1">// 参数一 字符串型，音频文件路径</span>
<span class="c1">// 参数二 字符串型，语言</span>
<span class="c1">// 成功返回转换后的音频文本，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">microphoneToText</span><span class="p">(</span><span class="nx">language</span><span class="p">);</span>
<span class="c1">// 麦克风输入音频换文本</span>
<span class="c1">// 参数一 字符串型，语言</span>
<span class="c1">// 成功返回转换后的音频文本，失败返回null</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-22-22-1" class="sphinx-tabs-panel" hidden="true" id="panel-22-22-1" name="22-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id19">
<h3>合成语音<a class="headerlink" href="#id19" title="此标题的永久链接">#</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-23-23-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-23-23-0" name="23-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-23-23-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-23-23-1" name="23-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-23-23-0" class="sphinx-tabs-panel" id="panel-23-23-0" name="23-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">textToBullhorn</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="nx">language</span><span class="p">,</span><span class="w"> </span><span class="nx">voiceName</span><span class="p">);</span>
<span class="c1">//文本合成语音输出到扬声器播放</span>
<span class="c1">//参数一 字符串型，要转换语音的文本</span>
<span class="c1">//参数二 字符串型，语言</span>
<span class="c1">//参数三 字符串型，发音人</span>
<span class="c1">//成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">textToAudioFile</span><span class="p">(</span><span class="nx">text</span><span class="p">,</span><span class="w"> </span><span class="nx">language</span><span class="p">,</span><span class="w"> </span><span class="nx">voiceName</span><span class="p">,</span><span class="w"> </span><span class="nx">audioPath</span><span class="p">);</span>
<span class="c1">//文本合成语音保存到本地音频文件</span>
<span class="c1">//参数一 字符串型，要转换语音的文本</span>
<span class="c1">//参数二 字符串型，语言</span>
<span class="c1">//参数三 字符串型，发音人</span>
<span class="c1">//参数四 字符串型，保存音频文件路径，后缀必须为&quot;.mp3&quot;或者&quot;.wav&quot;</span>
<span class="c1">//成功返回true，失败返回false</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-23-23-1" class="sphinx-tabs-panel" hidden="true" id="panel-23-23-1" name="23-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="ssml">
<h3>SSML格式合成语音<a class="headerlink" href="#ssml" title="此标题的永久链接">#</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-24-24-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-24-24-0" name="24-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-24-24-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-24-24-1" name="24-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-24-24-0" class="sphinx-tabs-panel" id="panel-24-24-0" name="24-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">SSMLToBullhorn</span><span class="p">(</span><span class="nx">ssmlPath</span><span class="p">,</span><span class="w"> </span><span class="nx">language</span><span class="p">,</span><span class="w"> </span><span class="nx">voiceName</span><span class="p">);</span>
<span class="c1">//SSML文本格式合成音频到扬声器</span>
<span class="c1">//参数一 字符串型，SSML文本路径</span>
<span class="c1">//参数二 字符串型，语言</span>
<span class="c1">//参数三 字符串型，发音人</span>
<span class="c1">//成功返回true，失败返回false</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">SSMLToFile</span><span class="p">(</span><span class="nx">ssmlPath</span><span class="p">,</span><span class="w"> </span><span class="nx">language</span><span class="p">,</span><span class="w"> </span><span class="nx">voiceName</span><span class="p">,</span><span class="w"> </span><span class="nx">audioPath</span><span class="p">);</span>
<span class="c1">//SSML文本格式合成音频到扬声器</span>
<span class="c1">//参数一 字符串型，SSML文本路径</span>
<span class="c1">//参数二 字符串型，语言</span>
<span class="c1">//参数三 字符串型，发音人</span>
<span class="c1">//参数四 字符串型，保存音频文件路径</span>
<span class="c1">//成功返回true，失败返回false</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-24-24-1" class="sphinx-tabs-panel" hidden="true" id="panel-24-24-1" name="24-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id20">
<h3>语音翻译<a class="headerlink" href="#id20" title="此标题的永久链接">#</a></h3>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-25-25-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-25-25-0" name="25-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-25-25-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-25-25-1" name="25-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-25-25-0" class="sphinx-tabs-panel" id="panel-25-25-0" name="25-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">microphoneTranslationText</span><span class="p">(</span><span class="nx">sourceLanguage</span><span class="p">,</span><span class="w"> </span><span class="nx">targetLanguage</span><span class="p">);</span>
<span class="c1">// 麦克风音频翻译成目标语言文本</span>
<span class="c1">// 参数一 字符串型，要翻译的语言</span>
<span class="c1">// 参数二 字符串型，翻译后的语言</span>
<span class="c1">// 成功返回翻译后的语言文本，失败返回null</span>

<span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">audioFileTranslationText</span><span class="p">(</span><span class="nx">audioPath</span><span class="p">,</span><span class="w"> </span><span class="nx">sourceLanguage</span><span class="p">,</span><span class="w"> </span><span class="nx">targetLanguage</span><span class="p">);</span>
<span class="c1">// 音频文件翻译成目标语言文本</span>
<span class="c1">// 参数一 字符串型，要翻译的音频文件路径</span>
<span class="c1">// 参数二 字符串型，要翻译的语言</span>
<span class="c1">// 参数三 字符串型，翻译后的语言</span>
<span class="c1">// 成功返回翻译后的语言文本，失败返回null</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-25-25-1" class="sphinx-tabs-panel" hidden="true" id="panel-25-25-1" name="25-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
<section id="id21">
<h3>语言和发音人<a class="headerlink" href="#id21" title="此标题的永久链接">#</a></h3>
</section>
</section>
<section id="windowsdriver-exe">
<h2>关闭 WindowsDriver.exe 驱动程序<a class="headerlink" href="#windowsdriver-exe" title="此标题的永久链接">#</a></h2>
<div class="sphinx-tabs docutils container">
<div aria-label="Tabbed content" class="closeable" role="tablist"><button aria-controls="panel-26-26-0" aria-selected="true" class="sphinx-tabs-tab" id="tab-26-26-0" name="26-0" role="tab" tabindex="0">JavaScript</button><button aria-controls="panel-26-26-1" aria-selected="false" class="sphinx-tabs-tab" id="tab-26-26-1" name="26-1" role="tab" tabindex="-1">Python</button></div><div aria-labelledby="tab-26-26-0" class="sphinx-tabs-panel" id="panel-26-26-0" name="26-0" role="tabpanel" tabindex="0"><div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="k">await</span><span class="w"> </span><span class="nx">windowsBot</span><span class="p">.</span><span class="nx">closeDriver</span><span class="p">();</span>
</pre></div>
</div>
</div><div aria-labelledby="tab-26-26-1" class="sphinx-tabs-panel" hidden="true" id="panel-26-26-1" name="26-1" role="tabpanel" tabindex="0"><div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
</pre></div>
</div>
</div></div>
</section>
</section>


                </article>
              
              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../android_bot/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">上一页</p>
        <p class="prev-next-title">AndroidBot</p>
      </div>
    </a>
    <a class="right-next"
       href="../web_bot/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">下一页</p>
        <p class="prev-next-title">WebBot</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">主函数示例</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">注册主函数</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id3">等待超时</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id4">查找句柄</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id5">获取窗口名称</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id6">窗口操作</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id7">鼠标键盘</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id8">图色操作</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#ocr">OCR系统</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id9">元素操作</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">系统剪切板</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id11">启动进程</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#cmd">执行cmd命令</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#url">指定url下载文件</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#excel">Excel文档</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id12">验证码系统</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#nlp">自然语言处理(NLP)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">初始化NLP</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#chatgpt">chatGPT的使用</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id14">训练模型</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id15">训练数据文件</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">语音合成/识别服务</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">初始化语音服务</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id18">语音识别</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id19">合成语音</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#ssml">SSML格式合成语音</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">语音翻译</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id21">语言和发音人</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#windowsdriver-exe">关闭 WindowsDriver.exe 驱动程序</a></li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div class="tocsection sourcelink">
    <a href="../../_sources/dev_manual/window_bot/index.rst.txt">
      <i class="fa-solid fa-file-lines"></i> 显示源代码
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner"></div>
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">
  <p class="copyright">
    
      © Copyright 2023, Aibote.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">
  <p class="sphinx-version">
    Created using <a href="https://sphinx-doc.org/">Sphinx</a> 5.3.0.
    <br/>
  </p>
</div>
      
    </div>
  
  
    <div class="footer-items__end">
      
        <div class="footer-item"><p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.13.0.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>